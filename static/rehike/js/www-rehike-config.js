(function(){(function(){var a=window.rehike||{};a.config={};a.config.container_=null;a.config.props_=[];a.config.modifications_={};a.config.saveButton_=null;a.config.init=function(){var b=document.querySelector(".rehike-config-options-container"),c=b.querySelectorAll(".rehike-config-option");a.config.container_=b;b=0;for(var d=c.length;b<d;b++)a.config.props_.push(c[b]);a.eventDelegate.add("change","rehike-config-option-bool",a.config.onModifyBool_);a.eventDelegate.add("change","rehike-config-option-enum",a.config.onModifyEnum_);
a.eventDelegate.add("input","rehike-config-option-string",a.config.onModifyString_);a.eventDelegate.add("click","rehike-config-save-button",a.config.submit_);a.config.saveButton_=document.querySelector(".rehike-config-save-button");a.config.updateDependentProperties_();a.config.updatePropertyGroupDisplayStates_()};window.rehike=window.rehike||{};window.rehike.config=window.rehike.config||{};window.rehike.config.init=a.config.init;a.config.onModifyBool_=function(b){var c=b.getAttribute("data-cfg-name");
b=a["class"].has(b,"checked");a.config.modifyProp_(c,b)};a.config.onModifyEnum_=function(b){var c=b.getAttribute("data-cfg-name");b=b.querySelector("select").value;a.config.modifyProp_(c,b)};a.config.onModifyString_=function(b){var c=b.getAttribute("data-cfg-name");b=b.querySelector("input").value;a.config.modifyProp_(c,b)};a.config.modifyProp_=function(b,c){a.config.saveButton_.disabled=!1;a.config.modifications_[b]=c;a.config.updateDependentProperties_()};a.config.submit_=function(b){var c=JSON.stringify(a.config.modifications_),
d=new XMLHttpRequest;d.open("POST","/rehike/update_config");d.onload=function(){200==d.status&&("function"==typeof b?b():location.reload())};d.setRequestHeader("Content-Type","application/json");d.send(c)};a.config.getLocalPropValue_=function(b){if(a.config.modifications_[b])return a.config.modifications_[b];var c=a.config.container_.querySelector('[data-cfg-name="'+b+'"]');if(c){if(b=c.getAttribute("data-original-value"))return b}else{c=window._rehikeFullConfig||{};b=b.split(".");for(var d=0,e=b.length;d<
e;d++){var h=b[d];if(c[h]){if(c=c[h],"object"!=typeof c)return c}else break}}return null};a.config.updatePropertyGroupDisplayStates_=function(){for(var b=a.config.container_.querySelectorAll(".property-group"),c=0,d=b.length;c<d;c++){for(var e=b[c],h=e.parentNode,k=0,m=0,l=e.children.length;m<l;m++){var g=e.children[m];"none"!=getComputedStyle(g).display&&0<g.clientWidth&&0<g.clientHeight&&k++}0!=k?a["class"].has(h,"hid")&&a["class"].remove(h,"hid"):a["class"].has(h,"hid")||a["class"].add(h,"hid");
1<k?a["class"].has(e,"multiple-children-visible")||a["class"].add(e,"multiple-children-visible"):a["class"].has(e,"multiple-children-visible")&&a["class"].remove(e,"multiple-children-visible")}};a.config.updateDependentProperties_=function(){for(var b=a.config.container_.querySelectorAll(".dependent-property"),c=0,d=b.length;c<d;c++){var e=b[c];1==a.config.evaluateCondition_(e.getAttribute("data-condition"))?a["class"].has(e,"hid")&&a["class"].remove(e,"hid"):a["class"].has(e,"hid")||a["class"].add(e,
"hid")}a.config.updatePropertyGroupDisplayStates_()};a.config.evaluateCondition_=function(b){var c=RegExp("([A-Za-z0-9.]*)\\s?(==|\\!=|)\\s?(.*)");b=b.split("||");for(var d=0,e=b.length;d<e;d++)for(var h=b[d].split("&&"),k=0,m=h.length;k<m;k++){var l=h[k].trim(),g=l.match(c);var f=g.splice(1);console.log(g,f);if(1>f.length||3<f.length)return console.log("[rehike.config.evaluateCondition_] Parse error"),!1;var n=a.config.getLocalPropValue_(f[0]);g=f[1];if("!"==l[0]){if(1<f.length)return console.log("[rehike.config.evaluateCondition_] Parse error"),
!1;g="==";f[2]="false"}else""==g&&(g="==",f[2]="true");if("=="==g||"!="==g)if(l=f[2],console.log(f),console.log(n,l),f=String(n)==l?!0:!1,"!="==g&&(f=!f),1==f)return f}return!1}})();})();
