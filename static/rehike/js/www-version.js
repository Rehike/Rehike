(function(){(function(){rehike.version=rehike.version||{};rehike.version.activeDialogClass_=null;rehike.version.activeDialogController_=null;rehike.version.init=function(){var b=document.querySelector(".rehike-version-credits-button"),a=document.querySelector(".git-manager-pull-button");b&&rehike.util.events.add(b,"click",rehike.version.onClickCreditsButton_);a&&rehike.util.events.add(a,"click",rehike.version.onClickPullButton_)};rehike.version.onClickCreditsButton_=function(){var b=document.querySelector("#rehike-version-credits-dialog-container .rehike-dialog");
b&&(new rehike.Dialog(b,{initialState:"content"})).open()};rehike.version.onClickPullButton_=function(){var b=new XMLHttpRequest;b.open("GET","/rehike/ajax/git_ajax?action_pull=1");b.onload=function(){var a=JSON.parse(b.responseText);"SUCCESS"==a.status?window.location.reload():a.dialogHtml&&a.dialogRid&&(rehike.version.activeDialogClass_=rehike.version.getGitManagerDialogClass_(a.dialogRid),document.body.insertAdjacentHTML("beforeend",a.dialogHtml),a=document.querySelector("."+rehike.version.activeDialogClass_),
console.log(a),a=new rehike.Dialog(a,{initialState:"content",buttonHandlerCb:rehike.version.pullDialogProc_,preventOverflow:!0}),rehike.version.activeDialogController_=a,a.close=rehike.version.onCloseDialog_.bind(a),a.open())};b.send()};rehike.version.getGitManagerDialogClass_=function(b){return"rehike-dialog-rid-"+String(b)};rehike.version.pullDialogProc_=function(b,a,c){a&&rehike["class"].has(a,"confirm-button")&&(rehike.version.activeDialogController_&&rehike.version.activeDialogController_.close(),
document.querySelector(".git-manager-pull-button").click());return b(a,c)};rehike.version.onCloseDialog_=function(){console.log("hi");rehike.Dialog.prototype.close.call(this);document.querySelector("."+rehike.version.activeDialogClass_).remove();rehike.version.activeDialogController_=null;rehike.version.activeDialogClass_=null};rehike.version.init()})();})();
